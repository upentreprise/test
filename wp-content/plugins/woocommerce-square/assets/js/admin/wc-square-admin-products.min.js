"use strict";(function(){var e=[].indexOf;jQuery(document).ready(function(r){var t,i,a,s,n,o,c,d,_,p,u,l,h,f,m,w,v;if(v=null!=(f=window.typenow)?f:"",h=null!=(m=window.pagenow)?m:"","product"===v&&wc_square_admin_products.is_product_sync_enabled)return"edit-product"===h&&r("button.editinline").on("click",function(e){var t,i,a;return t=r(this).closest("tr"),a=t.find("th.check-column input").val(),i={action:"wc_square_is_product_synced_with_square",security:wc_square_admin_products.is_product_synced_with_square_nonce,product_id:t.find("th.check-column input").val()},r.post(wc_square_admin_products.ajax_url,i,function(e){var t,i,s,n,o,c,d;if(t=r("tr#edit-"+a),o=t.find("select.square-synced"),n=t.find("input[name=_sku]"),s=t.find("input[name=_manage_stock]"),d=t.find("select[name=_stock_status]"),c=t.find("input[name=_stock]"),i=t.find(".wc-square-sync-with-square-errors"),e&&e.data)return"multiple_attributes"===e.data?(o.prop("checked",!1),o.prop("disabled",!0),void i.find(".multiple_attributes").show()):"missing_variation_sku"===e.data?(o.prop("checked",!1),o.prop("disabled",!0),void i.find(".missing_variation_sku").show()):(o.val("missing_sku"===e.data?"no":e.data),n.on("change keyup keypress",function(e){return""===r(this).val()?(o.val("no"),o.prop("disabled",!0),i.find(".missing_sku").show()):(o.prop("disabled",!1),o.trigger("change"),i.find(".missing_sku").hide())}).trigger("change"),o.on("change",function(e){return"no"===r(this).val()?(s.prop("disabled",!1),d.prop("disabled",!1),c.prop("disabled",!1)):(s.prop("checked",!0),r(".stock_qty_field").show(),s.prop("disabled",!0),d.prop("disabled",!0),c.prop("disabled",!0))}).trigger("change"))})}),"product"===h?(w="#_"+wc_square_admin_products.synced_with_square_taxonomy,p=function(){var t;return t=r("#product-type").val(),e.call(wc_square_admin_products.variable_product_types,t)>=0},_=function(){return""!==r("#_sku").val()},d=function(){var e;return e=r('.woocommerce_attribute_data input[name^="attribute_variation"]:checked'),p()&&e&&e.length>1},c=function(e){if(!p())return r("#_sku").on("change keypress keyup",function(t){return""===r(this).val()?(r(".wc-square-sync-with-square-error.missing_sku").show(),r(e).prop("disabled",!0),r(e).prop("checked",!1)):(r(".wc-square-sync-with-square-error.missing_sku").hide(),d()||r(e).prop("disabled",!1)),r(e).trigger("change")}).trigger("change")},o=function(e){return r("#variable_product_options").on("reload",function(t){return d()?(r(".wc-square-sync-with-square-error.multiple_attributes").show(),r(e).prop("disabled",!0),r(e).prop("checked",!1)):(r(".wc-square-sync-with-square-error.multiple_attributes").hide(),_()&&r(e).prop("disabled",!1)),r(e).trigger("change")}).trigger("reload")},c(w),o(w),s=r(".stock_fields"),n=s.find("#_stock"),i=r("._manage_stock_field"),a=i.find("#_manage_stock"),t=i.find(".description"),u=t.text(),l=r("#_manage_stock").is(":checked"),r(w).on("change",function(e){var i,o;if(wc_square_admin_products.is_inventory_sync_enabled)return o=-1!==r.inArray(r("#product-type").val(),wc_square_admin_products.variable_product_types),r(this).is(":checked")&&r("#_square_item_variation_id").length>0?(i=!0,t.html('<a href="'+wc_square_admin_products.settings_url+'">'+wc_square_admin_products.i18n.synced_with_square+"</a>"),a.prop("disabled",!0).prop("checked",!o).change(),n.prop("readonly",!0),o||s.show(),wc_square_admin_products.is_woocommerce_sor&&!o?(0===r("p._stock_field span.description").length&&n.after('<span class="description" style="display:block;clear:both;"><a href="#" id="fetch-stock-with-square">'+wc_square_admin_products.i18n.fetch_stock_with_square+'</a><div class="spinner" style="float:none;"></div></span>'),r("#fetch-stock-with-square").on("click",function(e){var t,i;return e.preventDefault(),(t=r("p._stock_field span.description .spinner")).css("visibility","visible"),i={action:"wc_square_fetch_product_stock_with_square",security:wc_square_admin_products.fetch_product_stock_with_square_nonce,product_id:r("#post_ID").val()},r.post(wc_square_admin_products.ajax_url,i,function(e){var i;return e&&e.success?(i=e.data,n.val(i),s.find("input[name=_original_stock]").val(i),n.prop("readonly",!1),r("p._stock_field span.description").remove()):(e.data&&(r(".inventory-fetch-error").remove(),t.after('<span class="inventory-fetch-error" style="display:inline-block;color:red;">'+e.data+"</span>")),t.css("visibility","hidden"),console.log(e))})})):wc_square_admin_products.is_square_sor&&0===r("p._stock_field span.description").length&&n.after('<span class="description" style="display:block;clear:both;">'+wc_square_admin_products.i18n.managed_by_square+"</span>")):(i=!1,r("p._stock_field span.description").remove(),n.prop("readonly",!1),t.html(u),a.prop("disabled",!1).prop("checked",l),l&&s.show()),r(".woocommerce_variation").each(function(){var e,t,a,s,n,o;return o=r(this).find("h3 > a").attr("rel"),t=r(".variable_manage_stock"),e=t.parent(),s=r(this).find(".wc_input_stock"),a=s.parent(),i?(t.prop("disabled",!0).prop("checked",!0).change(),s.prop("readonly",!0),r("#wc_square_variation_manage_stock").prop("disabled",!1),0===e.find(".description").length&&t.after('<span class="description">('+wc_square_admin_products.i18n.managed_by_square+")</span>"),wc_square_admin_products.is_woocommerce_sor?(n="fetch-stock-with-square-"+o,0===a.find("span.description").length&&s.after('<span class="description" style="display:block;clear:both;"><a href="#" id="'+n+'">'+wc_square_admin_products.i18n.fetch_stock_with_square+'</a><div class="spinner" style="float:none;"></div></span>'),r("#"+n).on("click",function(e){var t,i;return e.preventDefault(),(t=r(this).next(".spinner")).css("visibility","visible"),i={action:"wc_square_fetch_product_stock_with_square",security:wc_square_admin_products.fetch_product_stock_with_square_nonce,product_id:o},r.post(wc_square_admin_products.ajax_url,i,function(e){var i;return e&&e.success?(i=e.data,s.val(i),a.parent().find('input[name^="variable_original_stock"]').val(i),s.prop("readonly",!1),a.find(".description").remove()):(e.data&&(r(".inventory-fetch-error").remove(),t.after('<span class="inventory-fetch-error" style="display:inline-block;color:red;">'+e.data+"</span>")),t.css("visibility","hidden"),console.log(e))})})):void 0):(s.prop("readonly",!1),t.prop("disabled",!1),t.next(".description").remove(),r("#wc_square_variation_manage_stock").prop("disabled",!0))})}).trigger("change"),r("#product-type").on("change",function(e){return r(w).trigger("change")}),r("#woocommerce-product-data").on("woocommerce_variations_loaded",function(e){return r(w).trigger("change")})):void 0})}).call(void 0);
//# sourceMappingURL=wc-square-admin-products.min.js.map